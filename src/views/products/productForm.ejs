<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/head') %>
    <link rel="stylesheet" href="/css/styles-formProduct.css">
    <script src="/js/productValidator.js"></script>
    <title>Agregar Producto</title>

</head>

<body>
    <header>
        <div class="header__container">
            <div class="header__logo">
                <a href="/">
                    <img src="/images/logo-golosinas-mailin.svg" class="header__logo--img" alt="golosinas-mailin" />
                </a>
            </div>

        </div>

    </header>
    <main>
        <div class="main__enlaces">
            <a href="/">Inicio </a><span class="span"> > </span><a href="/productos"> Productos</a><span class="span"> > </span><a href="/productos/create"> Agregar</a>
        </div>
        
        <div class="form-contenedor">
            
            <form action="/productos" method="POST" enctype="multipart/form-data"  class="formulario" >
                <h2 class="form-titulo">Agregar Producto</h2>

            
                <div class="form-items form-items-1">
                    <label for="nombreProducto">Nombre del producto<span class="span-label">*</span></label>
                    <div class="form-input <%= locals.errors && locals.errors.nombre ? 'is-invalid' : null %>" id="input-name">
                        <input type="text" name="nombre" id="nombreProducto" class="input-nombre" value="<%= locals.oldData ? oldData.nombre : null %>">
                        <% if (locals.errors && locals.errors.nombre) { %>
                            <i class="fa-solid fa-circle-exclamation"></i>
                        <% } %>
                    </div>

                    <small class="text-danger" id = "errorNombre"></small>

                    <% if (locals.errors && locals.errors.nombre) { %>
                        <small class="text-danger">
                            <%= locals.errors.nombre.msg %>
                        </small>
                        <% } %>

                </div>


                <div class="form-items form-items-1">
                    <label for="descripcionProducto" class="form__label">Descripción<span class="span-label">*</span></label>
                    <div class="form-input <%= locals.errors && locals.errors.descripcion ? 'is-invalid' : null %>">
                        <textarea name="descripcion" id="descripcionProducto" cols="30"><%= locals.oldData ? oldData.descripcion : ""%></textarea>
               
                    </div>

                    <small class="text-danger" id = "errorDescripcion"></small>

                    <% if (locals.errors && locals.errors.descripcion) { %>
                        <small class="text-danger">
                            <%= locals.errors.descripcion.msg %>
                        </small>
                        <% } %>
                </div>
                

                <div class="form-items form-items-1">
                    <label for="imagenproducto">Seleccionar imagen</label>
                    <input type="file" name="imagen" id="imagenproducto" accept=".jpg, .png" class="input-foto" <%= locals.errors && locals.errors.imagen ? 'is-invalid' : null %>>
                    
                    <small class="text-danger" id = "errorImagen"></small>
                    
                    <% if (locals.errors && errors.imagen) { %>
                        <small class="text-danger">
                            <%= errors.imagen.msg %>
                        </small>
                        <% } %>
                </div>
                
                <div class="form-items form-items-1 contenedor-categorias">
                   
                    <label for="categoriaProducto"> Categoría </label>
                    <div class="form-input <%= locals.errors && locals.errors.categoria ? 'is-invalid' : null %>">
                        <select name="categoria" id="categoriaProducto" class="categorias">
                            <% categorias.forEach(element => {%>
                                <option value = "<%= element.id %>"><%= element.nombre %></option>  
                            <% }); %>
                        </select>

                    </div>
                    <% if (locals.errors && locals.errors.categoria) { %>
                        <small class="text-danger">
                            <%= locals.errors.categoria.msg %>
                        </small>
                        <% } %>

                </div>

                <div class="form-items">
                    <label for="stockProducto"> Stock<span class="span-label">*</span></label>
                    <div class="form-input-number <%= locals.errors && locals.errors.stock ? 'is-invalid' : null %>">
                        <input type="number" min="0" name="stock" id="stockProducto" class="input-stock" placeholder="0" value="<%= locals.oldData ? oldData.stock : null %>">
        
                    </div>

                    <small class="text-danger" id = "errorStock"></small>

                    <% if (locals.errors && locals.errors.stock) { %>
                        <small class="text-danger">
                            <%= locals.errors.stock.msg %>
                        </small>
                        <% } %>
                </div>

                <div class="form-items">
                    <label for="enOferta"> En oferta </label>
                    <input type = "checkbox" name = "en_oferta" value=1  id = "enOferta" class="input-oferta" >
          
                    <% if (locals.errors && locals.errors.en_oferta) { %>
                        <small class="text-danger">
                            <%= locals.errors.en_oferta.msg %>
                        </small>
                        <% } %>
                </div>

                <div class="form-items">
                    <label for="precioProducto"> Precio $ <span class="span-label">*</span></label>

                    <div class="form-input-number <%= locals.errors && locals.errors.precio ? 'is-invalid' : null %>">
                    <input type="number" min="0" step="0.1" name="precio" id="precioProducto" class="input-precio" placeholder="0.00" value="<%= locals.oldData ? oldData.precio : null %>">
        
                    </div>

                    <small class="text-danger" id = "errorPrecio"></small>

                    <% if (locals.errors && locals.errors.precio) { %>
                        <small class="text-danger">
                            <%= locals.errors.precio.msg %>
                        </small>
                        <% } %>
                </div>

                <div class="form-items">
                    <label for="descuento"> Descuento % <span class="span-label">*</span></label>
                    <div class="form-input-number <%= locals.errors && locals.errors.descuento ? 'is-invalid' : null %>">
                        <input type="number" min="0" name="descuento" id="descuento" class="input-descuento" placeholder="0" value="<%= locals.oldData ? oldData.descuento : null %>">
            
                    </div>

                    <small class="text-danger" id = "errorDescuento"></small>

                    <% if (locals.errors && locals.errors.descuento) { %>
                        <small class="text-danger">
                            <%= locals.errors.descuento.msg %>
                        </small>
                        <% } %>
                </div>

                <div class="botones-form">
                    <a type="button" class="action-button btn-regresar" href="/productos"> Regresar </a>
                    <button type="submit" class="action-button btn-guardar"> Guardar </button>

                </div>
            </form>
        </div>
    </main>

</body>

</html>